---
title: "Group04 Presentation R4BDS"
author: "Eric Calaveras - Sol Escamilla - Beatriz García - Lucía López - Diego Medina"
format: revealjs
editor: visual
---

## Content
Group 04 R for Bio Data Science
Eric Calaveras
Sol Escamilla
Beatriz García
Lucía López
Diego Medina

Microarray data processing and visualization

## Introduction

Dataset content:

-   x: probes IDs and  gene expression values of each sample

-   y: diagnosis (symptomatic, control)

The desired output to start working with the dataset is a tibble with tidy data:

1.  Each row is an observation
2.  Each column is a variable
3.  Each cell is a single value

## Wrangling I: initial tibble

Explicar por qué necesitamos agregar sample/diagnosis y convertir a tibble

## Wrangling II: Pivot_longer

Explicar que pasar los probes a filas es el paso más importante para tener "tidy data", y por qué esto facilita cualquier análisis despues.

## Bioconductor

Explicar el annotation package

Gracias al paquete hgu133a.db (database) podemos asociar los probes a genes a partir de la columna SYMBOL. (código de Sol)

## Linear Modelling (Obtaining gene-level data)

<br>

Let `R` know that we want to work per gene, to do that we define a Linear Model, the analysis requires:

-   Tidy data, to obtain it we will pivot the wide format

<br>

```{r eval=FALSE}
borovecki_tibble_long <- borovecki_tibble  |> 
  pivot_longer(
    cols = -Diagnosis,
    names_to = "gene",
    values_to = "log2_expr_level"
  ) |>
  mutate(
    log2_expr_level = log2(log2_expr_level)
  )
```

<br>

-   Group the tidy data by `gene` and then add the `nest()` and `ungroup()` functions to your pipeline

<br>

```{r eval=FALSE}
borovecki_tibble_long_nested <- borovecki_tibble_long |> 
  group_by(gene) |> 
  nest() |> 
  ungroup()
```

## Fitting the model

<br>

We created a function that applies a linear model. Applying the function `map()` to the `borovecki_tibble_long_nested` *per* gene.

The result is a **`<tibble [13,039× 3]>`** where each row is a gene with two nested data frames.

-   The first one contains multiples rows with (diagnosis + log2_expr_level)

-   The second one contains the output of the linear function.

    <br>

```{r eval=FALSE}
borovecki_tibble_long <- borovecki_tibble  |> 
  pivot_longer(
    cols = -Diagnosis,
    names_to = "gene",
    values_to = "log2_expr_level"
  ) |>
  mutate(
    log2_expr_level = log2(log2_expr_level)
  )
```

## Log2 transformation and categories


Almost all values are concentrated near zero, while one or a few values reach very high levels.This makes it nearly impossible to interpret the distribution or compare expression between genes. To address this, we apply a log2 transformation to the expression values.

This transformation serves five purposes:

1.  Normalise the distribution, reducing the influence of extremely large values.

2.  Spread out lower values, making subtle differences more interpretable.

3.  Better comparison between genes and a more normal-like distribution.

4.  We lose outliers influence, the variation becomes more uniform and the trend line becomes more stable.

5.  All this improvements reflect the biological trends more reliably.

## Visualization 1


```{r, echo=FALSE}


```

## Visualization 2



## Discussion

Gracias a usar todas estas herramientas hemos podido encontrar genes mas singnificativos e importantes en esta enfermedad
