---
title: "Group04 Presentation R4BDS"
author: "Eric Calaveras - Sol Escamilla - Beatriz García - Lucía López - Diego Medina"
format: revealjs
editor: visual
css: styles.css
echo: True
---

## Introduction

<div>

<br>

![](images/Borovecki$x-01.png){fig-align="center"}

</div>

## Materials and methods

#### Data Wrangling: From messy to tidy data

<br>

---
layout: 2-col
---

::: column
```{r eval=FALSE}

borovecki <- borovecki$x |>
  as_tibble() |>
  mutate(
    sample = row_number(), 
    .before = 1, 
    diagnosis = borovecki$y
  )

borovecki <- borovecki |>
  pivot_longer(
    cols = ends_with("at"),
    names_to = "probeID", 
    values_to = "expressionValue",
    values_drop_na = TRUE
  )
```
:::

## Materials and methods

#### Data Wrangling: From messy to tidy data

---
layout: 2-col
---

::: column
```{r eval=FALSE}

borovecki <- borovecki |>
  mutate(
    gene = mapIds(
      hgu133a.db, 
      keys=probeID, 
      keytype = "PROBEID", 
      column="SYMBOL",
      multiVals="first"
    )
  ) |>
  filter(!is.na(gene)) |>
  dplyr::select(-probeID)

borovecki_geneLevel <- borovecki |>
  group_by(sample, gene) |>
  summarise(expression = mean(expression), .groups = "drop")
```
:::

## Materials and methods

#### Normalization: From raw to standardize  data

![](images/comparison1_raw_log2-05.png){fig-align="center"}

## Materials and methods

#### Linear Modelling

<br>

---
layout: 2-col
---

::: column
```{r eval=FALSE}
borovecki_tibble <- borovecki_tibble |>
  pivot_wider(
    # Columns not to pivot
    id_cols = c(sample, diagnosis),
    # Columns to pivot
    names_from = gene,
    values_from = expressionValue
  ) |>
  mutate(
    Diagnosis = case_when(
      diagnosis == "symptomatic" ~ 1,
      diagnosis == "control" ~ 0
    )
  ) |>
  dplyr::select(-c(diagnosis,sample)) |>
  relocate(Diagnosis, .before = 1)

borovecki_tibble_long <- borovecki_tibble  |> 
  pivot_longer(
    cols = -Diagnosis,
    names_to = "gene",
    values_to = "log2_expr_level"
  ) |>
  mutate(
    log2_expr_level = log2(log2_expr_level)
  )
borovecki_tibble_long_nested <- borovecki_tibble_long |> 
  group_by(gene) |> 
  nest() |> 
  ungroup()
```
:::

::: column
![](images/Borovecki_tibble.png){width="500"}

![](images/borovecki__tibble_long.png){width="500"}

![](images/borovecki_tibble_long_nested_prelm.png){width="500"}
:::

## Materials and methods

#### Linear Modeling

<br>

---
layout: 2-col
---

::: column
```{r eval=FALSE}
by_gene <- borovecki_tibble_long_nested |> 
  group_by(gene)
linear_model <- function(df) {
  lm(
  log2_expr_level ~ Diagnosis , 
  data = df)
}
borovecki_tibble_long_nested  <- borovecki_tibble_long_nested  |>  
  mutate(model_object = map(data, linear_model))
tidy_data <- function(df) {
  df |>
  tidy(conf.int = TRUE,
       conf.level = 0.95)
  }
borovecki_estimates <- borovecki_tibble_long_nested |>
  mutate(model_object_tidy = map(model_object, tidy_data)) |>
  unnest(model_object_tidy) |>
  filter(term == "Diagnosis") |>
  dplyr::select(gene, p.value, estimate, conf.low, conf.high) |> 
  mutate(q.value=p.adjust(p.value),
          is_significant = case_when(
            q.value >= 0.05 ~ "no",
            q.value < 0.05 ~ "yes"
            ),
         lbl = case_when(
           q.value < 0.05 ~ gene,
           q.value >= 0.05 ~ "")
         )
```
:::

::: column
![](images/borovecki_tibble_long_nested.png)

![](images/borovecki_estimate.png)
:::

## Results

#### Dataset exploration in established genetic modifiers

![](images/Expression_of_DNA_repair_genes_vs_clinical_outcome-01.png){fig-align="center"}

## Results

#### Forest Plot

<br>

![](images/forest-04.png){fig-align="center"}

## Results

#### Volcano Plot

<br>

![](images/volcano-01.png){fig-align="center"}

## Discussion

<br>

-   Use of different functions in RStudio allowed us to tidy the initial raw dataset to work with it.

-   Combining our tidy data with the bibliography, allowed us to see the difference in the expressions by applying different plots.

    <br>

    #### Future perspectives

    <br>

-   This methodology could be translated for other diseases in the future.

-   More collaboration between hospitals and bioinformaticians to use the data they obtain in order to get a better understanding of how different diseases work.

    #### 
