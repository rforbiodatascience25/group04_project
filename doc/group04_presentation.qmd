---
title: "Group04 Presentation R4BDS"
author: "Eric Calaveras - Sol Escamilla - Beatriz García - Lucía López - Diego Medina"
format: revealjs
editor: visual
css: styles.css
echo: True
---

## Introduction

<div>

<br>

</div>

## Materials and methods

#### Data Wrangling: From raw to tidydata

<br>

------------------------------------------------------------------------

layout: 2-col

------------------------------------------------------------------------

::: column
```{r eval=FALSE}

borovecki <- borovecki$x |>
  as_tibble() |>
  mutate(
    sample = row_number(), 
    .before = 1, 
    diagnosis = borovecki$y
  )

borovecki <- borovecki |>
  pivot_longer(
    cols = ends_with("at"),
    names_to = "probeID", 
    values_to = "expressionValue",
    values_drop_na = TRUE
  )

```
:::

::: column

Imagen de la tibble
:::

## Materials and methods

<<<<<<< HEAD
#### Data Wrangling: From to tidydata
=======
#### Wrangling II Pivot_longer
>>>>>>> e2cff1ddcb25836e1f8aa3d6a87622ab6db0414a

---
layout: 2-col
---

::: column
```{r}
#| message = FALSE
borovecki <- borovecki |>
  mutate(
    gene = mapIds(
      hgu133a.db, 
      keys=probeID, 
      keytype = "PROBEID", 
      column="SYMBOL",
      multiVals="first"
    )
  ) |>
  filter(!is.na(gene)) |>
  # I specify the package because AnnotationDbi also has a select function
  dplyr::select(-probeID)

borovecki_geneLevel <- borovecki |>
  group_by(sample, gene) |>
  summarise(expression = mean(expression), .groups = "drop")

```
:::

::: column
imagen de la tibble
:::

## Materials and methods

#### Normalization: From messy to tiddy

![](images/comparison1_raw_log2-05.png){fig-align="center"}

## Materials and methods

#### Linear Modelling 

---
layout: 2-col
---

::: column
```{r}
borovecki_tibble <- borovecki_tibble |>
  pivot_wider(
    # Columns not to pivot
    id_cols = c(sample, diagnosis),
    # Columns to pivot
    names_from = gene,
    values_from = expressionValue
  ) |>
  mutate(
    Diagnosis = case_when(
      diagnosis == "symptomatic" ~ 1,
      diagnosis == "control" ~ 0
    )
  ) |>
  dplyr::select(-c(diagnosis,sample)) |>
  relocate(Diagnosis, .before = 1)

borovecki_tibble_long <- borovecki_tibble  |> 
  pivot_longer(
    cols = -Diagnosis,
    names_to = "gene",
    values_to = "log2_expr_level"
  ) |>
  mutate(
    log2_expr_level = log2(log2_expr_level)
  )
borovecki_tibble_long_nested <- borovecki_tibble_long |> 
  group_by(gene) |> 
  nest() |> 
  ungroup()
```
:::

::: column
imagen de la tibble
:::

## Materials and methods

#### Linear Modeling

<br>

---
layout: 2-col
---

::: column
```{r}
by_gene <- borovecki_tibble_long_nested |> 
  group_by(gene)
# Define lm function
linear_model <- function(df) {
  lm(
  log2_expr_level ~ Diagnosis , 
  data = df)
}
# Apply lm function to each gene
borovecki_tibble_long_nested  <- borovecki_tibble_long_nested  |>  
  mutate(model_object = map(data, linear_model))
```
:::

::: column
imagen
:::

## Results

#### Dataset exploration in established genetic modifiers

![](images/Expression_of_DNA_repair_genes_vs_clinical_outcome-01.png){fig-align="center"}

## Results

#### Forest Plot

<br>

![](images/forest-04.png){fig-align="center"}

## Results

#### Volcano Plot

<br>

![](images/volcano-01.png){fig-align="center"}

## Discussion

<br>

-   Use of different functions in RStudio allowed us to tidy the initial raw dataset to work with it.

-   Combining our tidy data with the bibliography, allowed us to see the difference in the expressions by applying different plots.

    <br>

    #### Future perspectives

    <br>

-   This methodology could be translated for other diseases in the future.

-   More collaboration between hospitals and bioinformaticians to use the data they obtain in order to get a better understanding of how different diseases work.

    #### 
